# Phase 5 Tests â€” Integration & UI Polish

## ðŸ“‹ Overview

Ð¢ÐµÑÑ‚Ñ‹ Ð¤Ð°Ð·Ñ‹ 5 Ñ„Ð¾ÐºÑƒÑÐ¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð½Ð° **Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ð¼ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¸** Ð¸ **UI ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð°Ñ…** Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ DOM (jsdom).

### Test Files

| File | Description |
|------|-------------|
| `Integration.test.js` | Ð¢ÐµÑÑ‚Ñ‹ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð²ÑÐµÑ… ÑÐ»Ð¾Ñ‘Ð² Ð¸Ð³Ñ€Ñ‹ |
| `UIController.dom.test.js` | Ð¢ÐµÑÑ‚Ñ‹ UIController Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼ DOM |
| `InputHandler.events.test.js` | Ð¢ÐµÑÑ‚Ñ‹ InputHandler Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ keyboard ÑÐ¾Ð±Ñ‹Ñ‚Ð¸ÑÐ¼Ð¸ |
| `GameFlow.test.js` | Ð¢ÐµÑÑ‚Ñ‹ Ð¿Ð¾Ð»Ð½Ð¾Ð³Ð¾ Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð³Ð¾ Ñ†Ð¸ÐºÐ»Ð° (start â†’ play â†’ gameover) |

---

## ðŸŽ¯ Coverage Intentions

### Integration.test.js

ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ðµ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð¼ÐµÐ¶Ð´Ñƒ ÑÐ»Ð¾ÑÐ¼Ð¸:

- **Domain â†’ Application**: ÑÑƒÑ‰Ð½Ð¾ÑÑ‚Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð¸Ð³Ñ€Ð¾Ð²Ñ‹Ð¼ Ñ†Ð¸ÐºÐ»Ð¾Ð¼
- **Application â†’ Presentation**: Ð¸Ð³Ñ€Ð° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‘Ñ‚ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð»Ñ Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³Ð°
- **Application â†’ Infrastructure**: Ñ€ÐµÐºÐ¾Ñ€Ð´Ñ‹ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ/Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÑŽÑ‚ÑÑ
- **Presentation â†’ Application**: Ð²Ð²Ð¾Ð´ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÑÐµÑ‚ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¸Ð³Ñ€Ñ‹

### UIController.dom.test.js

ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ UI ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼ DOM:

- **HUD Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ**: ÑÑ‡Ñ‘Ñ‚, Ð¶Ð¸Ð·Ð½Ð¸, ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÑŽÑ‚ÑÑ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾
- **ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ ÑÐºÑ€Ð°Ð½Ð¾Ð²**: menu â†’ game â†’ pause â†’ gameover
- **ÐšÐ½Ð¾Ð¿ÐºÐ¸**: start/restart Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€ÑÑ‚ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ
- **ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ð¸**: level complete message Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ/Ð¸ÑÑ‡ÐµÐ·Ð°ÐµÑ‚

### InputHandler.events.test.js

ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹:

- **Key mappings**: ÑÑ‚Ñ€ÐµÐ»ÐºÐ¸, WASD, space, P, H
- **Edge detection**: wasJustPressed Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾
- **Multi-key**: Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÐºÐ»Ð°Ð²Ð¸Ñˆ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾
- **Prevent default**: ÑÑ‚Ñ€ÐµÐ»ÐºÐ¸ Ð½Ðµ ÑÐºÑ€Ð¾Ð»Ð»ÑÑ‚ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ

### GameFlow.test.js

ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð¹ Ñ†Ð¸ÐºÐ»:

- **Start game**: menu â†’ playing, ÑÐ¿Ð°Ð²Ð½ Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ð¾Ð²
- **Gameplay**: Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ, ÑÑ‚Ñ€ÐµÐ»ÑŒÐ±Ð°, ÐºÐ¾Ð»Ð»Ð¸Ð·Ð¸Ð¸
- **Level complete**: Ð²ÑÐµ Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ñ‹ ÑƒÐ½Ð¸Ñ‡Ñ‚Ð¾Ð¶ÐµÐ½Ñ‹ â†’ next level
- **Game over**: Ð¶Ð¸Ð·Ð½Ð¸ Ð·Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð»Ð¸ÑÑŒ â†’ game over screen
- **High score**: Ñ€ÐµÐºÐ¾Ñ€Ð´ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð² localStorage

---

## ðŸ”§ Running Tests

```bash
# Run all Phase 5 tests
npm test -- src/tests/phase_5/

# Run with coverage
npm run test:coverage -- src/tests/phase_5/

# Watch mode
npm run test:watch -- src/tests/phase_5/
```

---

## ðŸ“Š Expected Coverage

| Component | Target | Focus |
|-----------|--------|-------|
| UIController | 90%+ | DOM Ð¼Ð°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ð¸ |
| InputHandler | 95%+ | Event handling |
| Game (integration) | 85%+ | Ð¡Ð»Ð¾Ð¸ Ð²Ð¼ÐµÑÑ‚Ðµ |
| GameState | 100% | Ð’ÑÐµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ñ‹ |

---

## ðŸš¨ Known Limitations

1. **Canvas Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³** â€” Ð½Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ð¾, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¼Ð¾ÐºÐ¸
2. **Audio** â€” Web Audio API Ð¼Ð¾ÐºÐ°ÐµÑ‚ÑÑ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ
3. **Timing-dependent Ñ‚ÐµÑÑ‚Ñ‹** â€” Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ fake timers
4. **ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ð¸** â€” Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ñ‹, Ð½Ðµ Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚

---

## âœ… Definition of Done

- [ ] Ð’ÑÐµ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ‚ÐµÑÑ‚Ñ‹ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´ÑÑ‚
- [ ] UI Ñ‚ÐµÑÑ‚Ñ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‚ Ñ jsdom
- [ ] InputHandler Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ñ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸ÑÐ¼Ð¸
- [ ] GameFlow Ð¿Ð¾ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ñ†Ð¸ÐºÐ» Ð¸Ð³Ñ€Ñ‹
- [ ] ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Phase 5 > 85%

---

**Phase:** 5 (UI/Polish)  
**Status:** Ready for Implementation  
**TDD Writer:** Complete
